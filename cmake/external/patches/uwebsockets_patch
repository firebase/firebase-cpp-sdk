308
17
                bool continue_loop = true;
                do {
                    sent = SSL_write(ssl, message->data, message->length);
                    static int bytes_written = 0;
                    bytes_written += sent;

                    if (sent == (ssize_t) message->length) {
                        wasTransferred = false;
                        return true;
                    }
                    else if (sent < 0) {
                        switch (SSL_get_error(ssl, sent)) {
                        case SSL_ERROR_WANT_READ:
                            continue_loop = false;
                            break;
                        case SSL_ERROR_WANT_WRITE:
                            break;                            
                        default:
                            return false;
                        }
                    }
                }  while (continue_loop);  

